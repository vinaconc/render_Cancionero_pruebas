\documentclass[a4paper,twoside,openany]{book}

% --- Codificación e idioma ---
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}

% --- Paquetes generales ---
\usepackage{xcolor}
% Usa la opción 'versenums' para que las estrofas se identifiquen con números
\usepackage[chorded, verse]{songs} 

% --- Paquetes adicionales ---
\usepackage{pdfpages}
\usepackage[normalem]{ulem}
\usepackage{scrextend}
\usepackage{imakeidx}
\usepackage{hyperref} 

% --- Geometría ---
\usepackage[a4paper,
            top=1cm, 
            bottom=2cm, 
            left=2.5cm, 
            right=1cm, 
            headheight=1.5cm,
            headsep=1cm,
            footskip=1.5cm,
            textwidth=16.5cm,
            textheight=23.42cm,
            showframe=false
            ]{geometry}

% --- Configuración para que no se encuadren las estrofas ---
\renewcommand{\stanza}[1]{\par\medskip} % elimina el recuadro
\renewcommand{\stanzaindent}{0pt}       % sin sangría
\renewcommand{\stanzahead}[1]{%         % letras de estrofa en margen
  \makebox[0pt][r]{\textbf{#1}\quad}%
}

% --- Configuraciones del paquete 'songs' ---
% Desactivar la numeración automática de los versos (si no la quieres)
\noversenumbers 
\baselineadj=-10pt plus 10pt minus 10pt
\renewcommand{\clineparams}{
    \baselineskip=35pt
    \lineskiplimit=35pt
    \lineskip=1pt
}

% === CONFIGURACIONES CLAVE PARA LA IDENTIFICACIÓN DE ESTROFAS ===
% Este comando convierte los números de verso a letras y las pone en el margen
% Para usarlo, simplemente agrega '\versenumsAsLetters' en tu código
\makeatletter
\def\versenumsAsLetters#1{\@arabicchar@true\count@#1
  \@whiledim\count@>\z@\do{%
    \advance\count@\m@ne
    \edef\next@char{\char\expandafter\strip@prefix\meaning\count@}%
    \edef\v@string{\next@char\v@string}%
  }%
  \def\v@next{}%
  \def\v@prev{}%
  \edef\v@out{\unexpanded\expandafter{\@v@num\v@string}}%
  \expandafter\let\expandafter\v@out\expandafter\@gobble\v@out
  \expandafter\let\expandafter\@v@num\expandafter\@v@num\expandafter\v@string%
}
\makeatother

% === COMANDOS PERSONALIZADOS DEL USUARIO ===
% ... (Mantén el resto de tus comandos personalizados como están) ...
\newcommand{\version}{}
\newsongkey{v}{\def\version{}}{\def\version{Versión: #1\par}}
\renewcommand{\extendprelude}{\showrefs\showauthors\toctitle {\bfseries\version}}
\newcommand{\indexword}[1]{\textcolor{blue}{#1}\index{#1}}

% --- INICIO DEL DOCUMENTO ---
\begin{document}

\frontmatter
\tableofcontents{\thispagestyle{empty}}
\clearpage

\mainmatter
\pagestyle{plain}

\renewcommand{\everychorus}{\textnote{CORO:}}
\renewcommand{\chorusfont}{\it}
\renewcommand{\printchord}[1]{\rmfamily\bf#1}

% --- INICIO CANCIONERO ---
% --- FIN CANCIONERO ---

\printindex[titleidx]
\end{document}

